<?xml version="1.0" encoding="UTF-8"?>
<!--

    Copyright (C) 2011-2019 Talend Inc.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

         http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.talend.esb</groupId>
        <artifactId>esb-parent</artifactId>
        <version>7.2.1</version>
    </parent>

    <groupId>org.talend.esb.assembly</groupId>
    <artifactId>talend-esb</artifactId>
    <name>Talend ESB :: Assembly</name>
    <packaging>pom</packaging>

    <properties>
        <zookeeper.package.version>${zookeeper.version}</zookeeper.package.version>
        <jclouds.version>2.1.2</jclouds.version>
        <pax-url-classpath.version>1.2.8</pax-url-classpath.version>
        <wss4j.version>2.2.2</wss4j.version>
        <xerces.version>2.12.0_1</xerces.version>
        <log4j.version>1.2.17</log4j.version>
        <pax-web.version>7.2.12</pax-web.version>
        <pax-logging.version>1.10.1</pax-logging.version>
        <javax-annotation.version>1.3.1</javax-annotation.version>
        <blueprint.core.version>1.8.3</blueprint.core.version>
        <jackson.version>2.9.9</jackson.version>
        <!-- Jetty version declared in parent POM -->
        <!-- <jetty.version>9.4.18.v20190429</jetty.version> -->
    </properties>

    <dependencies>
        <dependency>
            <groupId>org.talend.esb.sts</groupId>
            <artifactId>cxf-sts-war</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>
        <!-- workaround for pax-url-classpath bundle (TESB-6904) -->
        <dependency>
            <groupId>org.ops4j.pax.url</groupId>
            <artifactId>pax-url-classpath</artifactId>
            <version>${pax-url-classpath.version}</version>
            <type>jar</type>
        </dependency>
        <!-- workaround for Jackson version (TESB-26035) -->
        <!-- <dependency>
             <groupId>com.fasterxml.jackson.core</groupId>
             <artifactId>jackson-core</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.core</groupId>
             <artifactId>jackson-databind</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.core</groupId>
             <artifactId>jackson-annotations</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.dataformat</groupId>
             <artifactId>jackson-dataformat-cbor</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.dataformat</groupId>
             <artifactId>jackson-dataformat-csv</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.dataformat</groupId>
             <artifactId>jackson-dataformat-smile</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.dataformat</groupId>
             <artifactId>jackson-dataformat-xml</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.dataformat</groupId>
             <artifactId>jackson-dataformat-yaml</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.datatype</groupId>
             <artifactId>jackson-datatype-guava</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.datatype</groupId>
             <artifactId>jackson-datatype-jdk8</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.datatype</groupId>
             <artifactId>jackson-datatype-jsr310</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.jaxrs</groupId>
             <artifactId>jackson-jaxrs-base</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.jaxrs</groupId>
             <artifactId>jackson-jaxrs-json-provider</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.jr</groupId>
             <artifactId>jackson-jr-objects</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.module</groupId>
             <artifactId>jackson-module-afterburner</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.module</groupId>
             <artifactId>jackson-module-jaxb-annotations</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.module</groupId>
             <artifactId>jackson-module-jsonSchema</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.module</groupId>
             <artifactId>jackson-module-paranamer</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency>
        <dependency>
             <groupId>com.fasterxml.jackson.module</groupId>
             <artifactId>jackson-module-scala_2.11</artifactId>
             <version>${jackson.version}</version>
             <type>jar</type>
        </dependency> -->
    </dependencies>

    <build>
        <resources>
            <resource>
                <directory>${project.basedir}/src/main/filtered-resources</directory>
                <filtering>true</filtering>
                <includes>
                    <include>**/*</include>
                </includes>
            </resource>
            <resource>
                <directory>${project.basedir}/bin</directory>
                <filtering>true</filtering>
                <targetPath>bin</targetPath>
            </resource>
        </resources>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-resources-plugin</artifactId>
                <executions>
                    <execution>
                        <id>filter</id>
                        <phase>generate-resources</phase>
                        <goals>
                            <goal>resources</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.apache.karaf.tooling</groupId>
                <artifactId>karaf-maven-plugin</artifactId>
                <version>${karaf.version}</version>
                <executions>
                    <execution>
                        <id>add-features-to-repo</id>
                        <phase>process-resources</phase>
                        <goals>
                            <goal>features-add-to-repository</goal>
                        </goals>
                        <configuration>
                            <descriptors>
                                <descriptor>mvn:org.apache.karaf.features/standard/${karaf.version}/xml/features</descriptor>
                                <descriptor>mvn:org.apache.karaf.features/spring/${karaf.version}/xml/features</descriptor>
                                <descriptor>mvn:org.apache.karaf.features/spring-legacy/${karaf.version}/xml/features</descriptor>
                                <descriptor>mvn:org.apache.karaf.features/enterprise/${karaf.version}/xml/features</descriptor>
                                <descriptor>mvn:org.apache.karaf.features/enterprise-legacy/${karaf.version}/xml/features</descriptor>
                                <descriptor>mvn:org.apache.jclouds.karaf/jclouds-karaf/${jclouds.version}/xml/features</descriptor>
                                <descriptor>mvn:org.apache.karaf.decanter/apache-karaf-decanter/${decanter.version}/xml/features</descriptor>
                                <descriptor>mvn:org.ops4j.pax.web/pax-web-features/${pax-web.version}/xml/features</descriptor>
<!--                                 <descriptor>mvn:org.apache.cxf.karaf/apache-cxf/${cxf.version}/xml/features</descriptor> -->
<!--                                 <descriptor>mvn:org.apache.activemq/activemq-karaf/${activemq.version}/xml/features</descriptor> -->
<!--                                 <descriptor>mvn:org.apache.camel.karaf/apache-camel/${camel.version}/xml/features</descriptor> -->
<!--                                 <descriptor>file:${basedir}/target/dependencies/apache-camel-${camel.version}-features.xml</descriptor> -->
                                <descriptor>mvn:org.talend.esb/features/${project.version}/xml</descriptor>
                                <descriptor>mvn:org.talend.esb.auxiliary.storage/auxiliary-storage-features/${project.version}/xml</descriptor>
                            </descriptors>
                            <features>
                                <!-- Core Features -->
                                <feature>spring/4.3.22.RELEASE_2</feature>
                                <feature>spring/5.0.12.RELEASE_1</feature>
                                <feature>spring-jdbc/5.0.12.RELEASE_1</feature>
                                <feature>spring-tx/5.0.12.RELEASE_1</feature>
                                <feature>spring-jms/5.0.12.RELEASE_1</feature>
                                <feature>jetty</feature>
                                <feature>webconsole</feature>
                                <feature>eventadmin</feature>
                                <feature>wrap</feature>
                                <feature>wrapper</feature>
                                <feature>transaction</feature>
                                <feature>jpa</feature>
                                <feature>jndi</feature>
                                <feature>jms</feature>
                                <feature>aries-blueprint-spring</feature>
                                <!-- pax-web version patch (TESB-25945) -->
                                <feature>pax-web-core/${pax-web.version}</feature>
                                <feature>pax-jetty/${jetty.version}</feature>
                                <feature>pax-jetty-http2/${pax-web.version}</feature>
                                <feature>pax-war/${pax-web.version}</feature>
                                <!-- ActiveMQ Features -->
                                <feature>activemq</feature>
                                <feature>activemq-blueprint</feature>
                                <feature>activemq-broker</feature>
                                <feature>activemq-camel</feature>
                                <!-- CXF Features -->
                                <feature>cxf/${cxf.version}</feature>
                                <feature>cxf-abdera/${cxf.version}</feature>
                                <feature>cxf-commands/${cxf.version}</feature>
                                <feature>cxf-rs-description-swagger2/${cxf.version}</feature>
                                <feature>cxf-sts/${cxf.version}</feature>
                                <feature>cxf-wsn/${cxf.version}</feature>
                                <feature>cxf-xjc-runtime/${cxf.version}</feature>
                                <feature>wss4j/${wss4j.version}</feature>
                                <!-- Camel Features -->
                                <feature>camel</feature>
                                <feature>camel-core</feature>
                                <feature>camel-catalog</feature>
                                <feature>camel-blueprint</feature>
                                <feature>camel-spring</feature>
                                <feature>camel-scr</feature>
                                <feature>camel-ahc</feature>
                                <feature>camel-ahc-ws</feature>
                                <feature>camel-amqp</feature>
                                <feature>camel-apns</feature>
                                <feature>camel-asn1</feature>
                                <feature>camel-asterisk</feature>
                                <feature>camel-atmosphere-websocket</feature>
                                <feature>camel-atom</feature>
                                <feature>camel-atomix</feature>
                                <feature>camel-avro</feature>
                                <feature>camel-aws</feature>
<!--                                 <feature>camel-azure</feature> -->
                                <feature>camel-bam</feature>
                                <feature>camel-base64</feature>
                                <feature>camel-bean-validator</feature>
                                <feature>camel-beanio</feature>
                                <feature>camel-beanstalk</feature>
                                <feature>camel-barcode</feature>
                                <feature>camel-bindy</feature>
                                <feature>camel-boon</feature>
                                <feature>camel-box</feature>
                                <feature>camel-braintree</feature>
                                <feature>camel-cache</feature>
                                <feature>camel-caffeine</feature>
                                <feature>camel-cassandraql</feature>
                                <feature>camel-castor</feature>
<!--                                <feature>camel-cdi</feature-->
                                <feature>camel-chronicle</feature>
                                <feature>camel-chunk</feature>
                                <feature>camel-cm-sms</feature>
                                <feature>camel-cmis</feature>
                                <feature>camel-coap</feature>
                                <feature>camel-cometd</feature>
                                <feature>camel-consul</feature>
                                <feature>camel-context</feature>
                                <feature>camel-couchdb</feature>
                                <feature>camel-couchbase</feature>
                                <feature>camel-crypto</feature>
                                <feature>camel-crypto-cms</feature>
                                <feature>camel-csv</feature>
                                <feature>camel-cxf</feature>
                                <feature>camel-digitalocean</feature>
                                <feature>camel-disruptor</feature>
                                <feature>camel-dns</feature>
                                <feature>camel-docker</feature>
                                <feature>camel-drill</feature>
                                <feature>camel-dozer</feature>
                                <feature>camel-dropbox</feature>
                                <feature>camel-ehcache</feature>
                                <feature>camel-elsql</feature>
                                <feature>camel-elasticsearch</feature>
                                <feature>camel-etcd</feature>
                                <feature>camel-eventadmin</feature>
                                <feature>camel-exec</feature>
                                <feature>camel-facebook</feature>
                                <feature>camel-fastjson</feature>
                                <feature>camel-fhir</feature>
                                <feature>camel-flatpack</feature>
                                <feature>camel-fop</feature>
                                <feature>camel-freemarker</feature>
                                <feature>camel-ftp</feature>
                                <feature>camel-ganglia</feature>
                                <feature>camel-geocoder</feature>
                                <feature>camel-git</feature>
                                <feature>camel-github</feature>
                                <feature>camel-google-calendar</feature>
                                <feature>camel-google-drive</feature>
                                <feature>camel-google-mail</feature>
                                <feature>camel-google-pubsub</feature>
                                <feature>camel-grape</feature>
                                <feature>camel-groovy</feature>
                                <feature>camel-grpc</feature>
                                <feature>camel-gson</feature>
                                <feature>camel-guava-eventbus</feature>
                                <feature>camel-guice</feature>
                                <feature>camel-hawtdb</feature>
                                <feature>camel-hazelcast</feature>
                                <feature>camel-hdfs</feature>
                                <feature>camel-hdfs2</feature>
                                <feature>camel-headersmap</feature>
                                <feature>camel-hipchat</feature>
                                <feature>camel-hessian</feature>
                                <feature>camel-hl7</feature>
                                <feature>camel-http</feature>
                                <feature>camel-http4</feature>
                                <feature>camel-hystrix</feature>
                                <feature>camel-ibatis</feature>
                                <feature>camel-ical</feature>
                                <feature>camel-iec60870</feature>
<!--                                 <feature>camel-ignite</feature> -->
                                <feature>camel-infinispan</feature>
                                <feature>camel-irc</feature>
                                <feature>camel-ironmq</feature>
                                <feature>camel-jackson</feature>
                                <feature>camel-jacksonxml</feature>
                                <feature>camel-jasypt</feature>
                                <feature>camel-jaxb</feature>
                                <feature>camel-jbpm</feature>
                                <feature>camel-jcache</feature>
                                <feature>camel-jclouds</feature>
                                <feature>camel-jcr</feature>
                                <feature>camel-jdbc</feature>
                                <feature>camel-jetty9</feature>
                                <feature>camel-jetty</feature>
                                <feature>camel-jgroups</feature>
                                <feature>camel-jibx</feature>
                                <feature>camel-jing</feature>
                                <feature>camel-jms</feature>
                                <feature>camel-jmx</feature>
                                <feature>camel-jolt</feature>
                                <feature>camel-johnzon</feature>
                                <feature>camel-josql</feature>
                                <feature>camel-jpa</feature>
                                <feature>camel-jsch</feature>
<!--                                 <feature>camel-json-validator</feature> -->
                                <feature>camel-jsonpath</feature>
                                <feature>camel-jt400</feature>
                                <feature>camel-juel</feature>
                                <feature>camel-jxpath</feature>
                                <feature>camel-kafka</feature>
                                <feature>camel-kestrel</feature>
                                <feature>camel-krati</feature>
                                <feature>camel-kubernetes</feature>
                                <feature>camel-kura</feature>
                                <feature>camel-ldap</feature>
                                <feature>camel-ldif</feature>
                                <feature>camel-linkedin</feature>
                                <feature>camel-leveldb</feature>
                                <feature>camel-leveldb-java</feature>
                                <feature>camel-lucene</feature>
                                <feature>camel-lumberjack</feature>
                                <feature>camel-lzf</feature>
                                <feature>camel-mail</feature>
                                <feature>camel-master</feature>
                                <feature>camel-metrics</feature>
                                <feature>camel-milo</feature>
                                <feature>camel-mina</feature>
                                <feature>camel-mina2</feature>
                                <feature>camel-mllp</feature>
                                <feature>camel-mongodb</feature>
                                <feature>camel-mongodb-gridfs</feature>
                                <feature>camel-mqtt</feature>
                                <feature>camel-msv</feature>
                                <feature>camel-mustache</feature>
                                <feature>camel-mvel</feature>
                                <feature>camel-mybatis</feature>
                                <feature>camel-nagios</feature>
                                <feature>camel-nats</feature>
                                <feature>camel-netty</feature>
                                <feature>camel-netty-http</feature>
                                <feature>camel-netty4</feature>
                                <feature>camel-netty4-http</feature>
                                <feature>camel-ognl</feature>
                                <feature>camel-olingo2</feature>
                                <feature>camel-openshift</feature>
                                <feature>camel-optaplanner</feature>
                                <feature>camel-openstack</feature>
                                <feature>camel-opentracing</feature>
                                <feature>camel-paho</feature>
                                <feature>camel-paxlogging</feature>
                                <feature>camel-pdf</feature>
                                <feature>camel-pgevent</feature>
                                <feature>camel-printer</feature>
                                <feature>camel-protobuf</feature>
                                <feature>camel-pubnub</feature>
                                <feature>camel-quartz</feature>
                                <feature>camel-quartz2</feature>
                                <feature>camel-quickfix</feature>
                                <feature>camel-rabbitmq</feature>
                                <feature>camel-reactive-streams</feature>
                                <feature>camel-reactor</feature>
                                <feature>camel-restlet</feature>
                                <feature>camel-restlet-jackson</feature>
                                <feature>camel-restlet-gson</feature>
                                <feature>camel-rmi</feature>
                                <feature>camel-routebox</feature>
                                <feature>camel-rss</feature>
                                <feature>camel-rx</feature>
                                <feature>camel-sap-netweaver</feature>
                                <feature>camel-salesforce</feature>
                                <feature>camel-saxon</feature>
                                <feature>camel-scala</feature>
                                <feature>camel-schematron</feature>
                                <feature>camel-script-jruby</feature>
                                <feature>camel-script-javascript</feature>
                                <feature>camel-script-groovy</feature>
                                <feature>camel-script</feature>
                                <feature>camel-servicenow</feature>
                                <feature>camel-servlet</feature>
                                <feature>camel-servletlistener</feature>
                                <feature>camel-shiro</feature>
                                <feature>camel-sip</feature>
                                <feature>camel-sjms</feature>
                                <feature>camel-sjms2</feature>
                                <feature>camel-slack</feature>
                                <feature>camel-smpp</feature>
                                <feature>camel-snakeyaml</feature>
                                <feature>camel-snmp</feature>
                                <feature>camel-soap</feature>
                                <feature>camel-solr</feature>
                                <feature>camel-spark-rest</feature>
                                <feature>camel-splunk</feature>
                                <feature>camel-spring-batch</feature>
                                <feature>camel-spring-ldap</feature>
                                <feature>camel-spring-redis</feature>
                                <feature>camel-spring-security</feature>
                                <feature>camel-spring-ws</feature>
                                <feature>camel-sql</feature>
                                <feature>camel-ssh</feature>
                                <feature>camel-stax</feature>
                                <feature>camel-stream</feature>
                                <feature>camel-stomp</feature>
                                <feature>camel-string-template</feature>
                                <feature>camel-swagger</feature>
                                <feature>camel-swagger-java</feature>
                                <feature>camel-syslog</feature>
                                <feature>camel-tagsoup</feature>
                                <feature>camel-tarfile</feature>
                                <feature>camel-test</feature>
                                <feature>camel-test-karaf</feature>
                                <feature>camel-test-spring</feature>
                                <feature>camel-thrift</feature>
                                <feature>camel-tika</feature>
                                <feature>camel-twilio</feature>
                                <feature>camel-twitter</feature>
                                <feature>camel-undertow</feature>
                                <feature>camel-univocity-parsers</feature>
                                <feature>camel-urlrewrite</feature>
                                <feature>camel-vertx</feature>
                                <feature>camel-velocity</feature>
                                <feature>camel-weather</feature>
                                <feature>camel-websocket</feature>
                                <feature>camel-xmlbeans</feature>
                                <feature>camel-xmljson</feature>
                                <feature>camel-xmlrpc</feature>
                                <feature>camel-xmlsecurity</feature>
                                <feature>camel-xmpp</feature>
                                <feature>camel-xstream</feature>
                                <feature>camel-yammer</feature>
                                <feature>camel-zendesk</feature>
                                <feature>camel-zipfile</feature>
                                <feature>camel-zipkin</feature>
                                <feature>camel-zookeeper</feature>
<!--                                <feature>camel-zookeeper-master</feature>  -->
                                <!-- Decanter Features -->
                                <feature>decanter-collector-log</feature>
                                <feature>decanter-collector-log-socket</feature>
                                <feature>decanter-collector-file</feature>
                                <feature>decanter-collector-jmx</feature>
                                <feature>decanter-collector-camel</feature>
                                <feature>decanter-collector-rest</feature>
                                <feature>decanter-collector-system</feature>
                                <feature>decanter-collector-eventadmin</feature>
                                <feature>decanter-collector-jms</feature>
                                <feature>decanter-collector-socket</feature>
                                <feature>decanter-collector-mqtt</feature>
                                <feature>decanter-appender-log</feature>
                                <feature>decanter-appender-elasticsearch</feature>
                                <feature>decanter-appender-elasticsearch-jest</feature>
                                <feature>decanter-appender-file</feature>
                                <feature>decanter-appender-jdbc</feature>
                                <feature>decanter-appender-jms</feature>
                                <feature>decanter-appender-camel</feature>
                                <feature>decanter-appender-kafka</feature>
                                <feature>decanter-appender-mqtt</feature>
                                <feature>decanter-appender-redis</feature>
                                <feature>decanter-appender-rest</feature>
                                <feature>decanter-appender-mongodb</feature>
                                <feature>decanter-alerting-log</feature>
                                <feature>decanter-alerting-email</feature>
                                <!-- TESB Features -->
                                <feature>tesb-sam-agent</feature>
                                <feature>tesb-datasource-derby</feature>
                                <feature>tesb-datasource-h2</feature>
                                <feature>tesb-datasource-mysql</feature>
                                <feature>tesb-datasource-oracle</feature>
                                <feature>tesb-datasource-db2</feature>
                                <feature>tesb-datasource-postgresql</feature>
                                <feature>tesb-datasource-sqlserver</feature>
                                <feature>tesb-derby-starter</feature>
                                <feature>tesb-sam-server</feature>
                                <feature>tesb-sam-service-rest</feature>
                                <feature>tesb-sam-service-soap</feature>
                                <feature>tesb-locator-client</feature>
                                <feature>tesb-locator-soap-service</feature>
                                <feature>tesb-locator-rest-service</feature>
                                <feature>tesb-locator-commands</feature>
                                <feature>tesb-locator-monitor</feature>
                                <feature>talend-job-api</feature>
                                <feature>talend-job-controller</feature>
                                <feature>tesb-zookeeper-server</feature>
                                <feature>tesb-sts</feature>
                                <feature>camel-talendjob</feature>
                                <feature>tesb-jmx-http-agent</feature>
                                <feature>tesb-encryptor-command</feature>
                                <feature>tesb-policy-compression</feature>
                                <feature>tesb-policy-correlationid</feature>
                                <feature>tesb-policy-samenable</feature>
                                <feature>tesb-policy-transformation</feature>
                                <feature>request-callback</feature>
                                <feature>transport-jms</feature>
                                <!-- Aux features -->
                                <feature>jackrabbit-aux-bundles</feature>
                                <feature>tesb-aux-common</feature>
                                <feature>tesb-aux-client-rest</feature>
                                <feature>tesb-aux-persistence</feature>
                                <feature>tesb-aux-service-rest</feature>
                                <feature>tesb-aux-server</feature>
                                <feature>tesb-aux</feature>
                                <!-- Hibersap feature -->
                                <feature>talend-sap-hibersap</feature>
                            </features>
                            <repository>target/features-repo</repository>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <executions>
                    <execution>
                        <id>copy</id>
                        <phase>generate-resources</phase>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <configuration>
                            <artifactItems>
                                <!-- cfg files -->
                                <artifactItem>
                                    <groupId>org.talend.esb</groupId>
                                    <artifactId>locator</artifactId>
                                    <version>${project.version}</version>
                                    <type>cfg</type>
                                    <classifier>org.talend.esb.locator</classifier>
                                    <outputDirectory>target/dependencies/etc</outputDirectory>
                                    <destFileName>org.talend.esb.locator.cfg</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.talend.esb</groupId>
                                    <artifactId>sam-agent</artifactId>
                                    <version>${project.version}</version>
                                    <type>cfg</type>
                                    <classifier>org.talend.esb.sam.agent</classifier>
                                    <outputDirectory>target/dependencies/etc</outputDirectory>
                                    <destFileName>org.talend.esb.sam.agent.cfg</destFileName>
                                </artifactItem>
                                <!-- workarounds for Camel features descriptor -->
                                <artifactItem>
                                    <groupId>org.apache.camel.karaf</groupId>
                                    <artifactId>apache-camel</artifactId>
                                    <version>${camel.version}</version>
                                    <type>xml</type>
                                    <classifier>features</classifier>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>apache-camel-${camel.version}-features.xml</destFileName>
                                </artifactItem>
                                <!-- workarounds for CXF features descriptor -->
                                <artifactItem>
                                    <groupId>org.apache.cxf.karaf</groupId>
                                    <artifactId>apache-cxf</artifactId>
                                    <version>${cxf.version}</version>
                                    <type>xml</type>
                                    <classifier>features</classifier>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>apache-cxf-${cxf.version}-features.xml</destFileName>
                                </artifactItem>
                                <!-- patch for xalan and xerces version -->
                                <!--artifactItem>
                                    <groupId>org.apache.servicemix.bundles</groupId>
                                    <artifactId>org.apache.servicemix.bundles.xalan</artifactId>
                                    <version>${xalan.version}</version>
                                    <type>jar</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem-->
                                <artifactItem>
                                    <groupId>org.apache.servicemix.bundles</groupId>
                                    <artifactId>org.apache.servicemix.bundles.xerces</artifactId>
                                    <version>${xerces.version}</version>
                                    <type>jar</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                               <!-- workaround for pax-url-classpath bundle (TESB-6904) -->
                                <artifactItem>
                                     <groupId>org.ops4j.pax.url</groupId>
                                     <artifactId>pax-url-classpath</artifactId>
                                     <version>${pax-url-classpath.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <!-- Workaround for Karaf libraries in features -->
                                <artifactItem>
                                    <groupId>org.apache.karaf.diagnostic</groupId>
                                    <artifactId>org.apache.karaf.diagnostic.boot</artifactId>
                                    <version>${karaf.version}</version>
                                    <type>jar</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>org.apache.karaf.diagnostic.boot-${karaf.version}.jar</destFileName>
                                </artifactItem>
                               <artifactItem>
                                    <groupId>org.apache.karaf.jaas</groupId>
                                    <artifactId>org.apache.karaf.jaas.boot</artifactId>
                                    <version>${karaf.version}</version>
                                    <type>jar</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>org.apache.karaf.jaas.boot-${karaf.version}.jar</destFileName>
                                </artifactItem>
                                <!-- patch the jetty version (TESB-25945) -->
                                <artifactItem>
                                    <groupId>org.apache.karaf.features</groupId>
                                    <artifactId>standard</artifactId>
                                    <version>${karaf.version}</version>
                                    <classifier>features</classifier>
                                    <type>xml</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>standard-${karaf.version}-features.xml</destFileName>
                                </artifactItem>
                                <!-- patch for pax-logging-log4j2 (TESB-20573) -->
                                <artifactItem>
                                    <groupId>org.apache.karaf.features</groupId>
                                    <artifactId>framework</artifactId>
                                    <version>${karaf.version}</version>
                                    <classifier>features</classifier>
                                    <type>xml</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>framework-${karaf.version}-features.xml</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.ops4j.pax.logging</groupId>
                                    <artifactId>pax-logging-log4j2</artifactId>
                                    <version>${pax-logging.version}</version>
                                    <classifier>TESB</classifier>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>pax-logging-log4j2-${pax-logging.version}-TESB.jar</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.activemq</groupId>
                                    <artifactId>activemq-karaf</artifactId>
                                    <version>${activemq.version}</version>
                                    <type>xml</type>
                                    <classifier>features</classifier>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>activemq-karaf-${activemq.version}-features.xml</destFileName>
                                </artifactItem>
                                <!-- Patch jackson version (TESB-24693) -->
                                <artifactItem>
                                    <groupId>org.apache.karaf.features</groupId>
                                    <artifactId>enterprise</artifactId>
                                    <version>${karaf.version}</version>
                                    <classifier>features</classifier>
                                    <type>xml</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>enterprise-${karaf.version}-features.xml</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.karaf.features</groupId>
                                    <artifactId>spring</artifactId>
                                    <version>${karaf.version}</version>
                                    <classifier>features</classifier>
                                    <type>xml</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>spring-${karaf.version}-features.xml</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.karaf.features</groupId>
                                    <artifactId>spring-legacy</artifactId>
                                    <version>${karaf.version}</version>
                                    <classifier>features</classifier>
                                    <type>xml</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>spring-legacy-${karaf.version}-features.xml</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.activemq</groupId>
                                    <artifactId>activemq-karaf</artifactId>
                                    <version>${activemq.version}</version>
                                    <type>xml</type>
                                    <classifier>features-core</classifier>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>activemq-karaf-${activemq.version}-features-core.xml</destFileName>
                                </artifactItem>
                                <!-- patch the activemq-webconsole cfg (TESB-26606) -->
                                <artifactItem>
                                    <groupId>org.apache.activemq</groupId>
                                    <artifactId>activemq-karaf</artifactId>
                                    <version>${activemq.version}</version>
                                    <type>cfg</type>
                                    <classifier>activemq-webconsole</classifier>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>activemq-karaf-${activemq.version}-activemq-webconsole.cfg</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.cxf</groupId>
                                    <artifactId>cxf-core</artifactId>
                                    <version>${cxf.version}</version>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>cxf-core-${cxf.version}.jar</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.cxf</groupId>
                                    <artifactId>cxf-rt-transports-http</artifactId>
                                    <version>${cxf.version}</version>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>cxf-rt-transports-http-${cxf.version}.jar</destFileName>
                                </artifactItem>
                                <!-- patch for camel-core (TESB-25690) -->
                                <artifactItem>
                                    <groupId>org.apache.camel</groupId>
                                    <artifactId>camel-core</artifactId>
                                    <version>${camel.version}.tesb1</version>
                                    <type>jar</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>camel-core-${camel.version}.tesb1.jar</destFileName>
                                </artifactItem>
                                <!-- patch for Karaf org.apache.karaf.features.core bundle (TESB-25565) -->
                                <artifactItem>
                                    <groupId>org.apache.karaf.features</groupId>
                                    <artifactId>org.apache.karaf.features.core</artifactId>
                                    <version>${karaf.version}</version>
                                    <classifier>TESB</classifier>
                                    <type>jar</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>org.apache.karaf.features.core-${karaf.version}-TESB.jar</destFileName>
                                </artifactItem>
                                <!-- patch for org.apache.aries.blueprint.core (TESB-25393) -->
                                <artifactItem>
                                    <groupId>org.apache.aries.blueprint</groupId>
                                    <artifactId>org.apache.aries.blueprint.core</artifactId>
                                    <version>${blueprint.core.version}</version>
                                    <classifier>TESB</classifier>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>org.apache.aries.blueprint.core-${blueprint.core.version}-TESB.jar</destFileName>
                                </artifactItem>
                                <!-- patch for org.apache.karaf.config.core (TESB-25795) -->
                                <artifactItem>
                                    <groupId>org.apache.karaf.config</groupId>
                                    <artifactId>org.apache.karaf.config.core</artifactId>
                                    <version>${karaf.version}.tesb1</version>
                                    <type>jar</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>org.apache.karaf.config.core-${karaf.version}.tesb1.jar</destFileName>
                                </artifactItem>
                                <!-- patch for org.apache.karaf.jaas.modules (TESB-26507) -->
                                <artifactItem>
                                    <groupId>org.apache.karaf.jaas</groupId>
                                    <artifactId>org.apache.karaf.jaas.modules</artifactId>
                                    <version>${karaf.version}.tesb1</version>
                                    <type>jar</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>org.apache.karaf.jaas.modules-${karaf.version}.tesb1.jar</destFileName>
                                </artifactItem>
                                <!-- patch for decanter bundles (TESB-24788) -->
                                <artifactItem>
                                    <groupId>org.apache.karaf.decanter</groupId>
                                    <artifactId>apache-karaf-decanter</artifactId>
                                    <version>${decanter.version}</version>
                                    <type>xml</type>
                                    <classifier>features</classifier>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>apache-karaf-decanter-${decanter.version}-features.xml</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.karaf.decanter.appender</groupId>
                                    <artifactId>org.apache.karaf.decanter.appender.jms</artifactId>
                                    <version>${decanter.version}.tesb1</version>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>org.apache.karaf.decanter.appender.jms-${decanter.version}.tesb1.jar</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.karaf.decanter.appender</groupId>
                                    <artifactId>org.apache.karaf.decanter.appender.jms</artifactId>
                                    <version>${decanter.version}.tesb1</version>
                                    <type>cfg</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>org.apache.karaf.decanter.appender.jms-${decanter.version}.tesb1.cfg</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.karaf.decanter.collector</groupId>
                                    <artifactId>org.apache.karaf.decanter.collector.jms</artifactId>
                                    <version>${decanter.version}.tesb1</version>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>org.apache.karaf.decanter.collector.jms-${decanter.version}.tesb1.jar</destFileName>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.karaf.decanter.collector</groupId>
                                    <artifactId>org.apache.karaf.decanter.collector.jms</artifactId>
                                    <version>${decanter.version}.tesb1</version>
                                    <type>cfg</type>
                                    <outputDirectory>target/dependencies</outputDirectory>
                                    <destFileName>org.apache.karaf.decanter.collector.jms-${decanter.version}.tesb1.cfg</destFileName>
                                </artifactItem>
                               <!-- workaround for Jackson version (TESB-26035) -->
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.core</groupId>
                                     <artifactId>jackson-core</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.core</groupId>
                                     <artifactId>jackson-databind</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.core</groupId>
                                     <artifactId>jackson-annotations</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.dataformat</groupId>
                                     <artifactId>jackson-dataformat-cbor</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.dataformat</groupId>
                                     <artifactId>jackson-dataformat-csv</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.dataformat</groupId>
                                     <artifactId>jackson-dataformat-smile</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.dataformat</groupId>
                                     <artifactId>jackson-dataformat-xml</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.dataformat</groupId>
                                     <artifactId>jackson-dataformat-yaml</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.datatype</groupId>
                                     <artifactId>jackson-datatype-guava</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.datatype</groupId>
                                     <artifactId>jackson-datatype-jdk8</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.datatype</groupId>
                                     <artifactId>jackson-datatype-jsr310</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.jaxrs</groupId>
                                     <artifactId>jackson-jaxrs-base</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.jaxrs</groupId>
                                     <artifactId>jackson-jaxrs-json-provider</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.jr</groupId>
                                     <artifactId>jackson-jr-objects</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.module</groupId>
                                     <artifactId>jackson-module-afterburner</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.module</groupId>
                                     <artifactId>jackson-module-jaxb-annotations</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.module</groupId>
                                     <artifactId>jackson-module-jsonSchema</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.module</groupId>
                                     <artifactId>jackson-module-paranamer</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>com.fasterxml.jackson.module</groupId>
                                     <artifactId>jackson-module-scala_2.11</artifactId>
                                     <version>${jackson.version}</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                     <groupId>org.apache.cxf</groupId>
                                     <artifactId>cxf-rt-transports-http-jetty</artifactId>
                                     <version>${cxf.version}.tesb1</version>
                                     <type>jar</type>
                                     <outputDirectory>target/dependencies</outputDirectory>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                    <execution>
                        <id>unpack-karaf</id>
                        <phase>generate-resources</phase>
                        <goals>
                            <goal>unpack</goal>
                        </goals>
                        <configuration>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>org.apache.karaf</groupId>
                                    <artifactId>apache-karaf</artifactId>
                                    <version>${karaf.version}</version>
                                    <type>tar.gz</type>
                                    <outputDirectory>target/dependencies/unix</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.karaf</groupId>
                                    <artifactId>apache-karaf</artifactId>
                                    <version>${karaf.version}</version>
                                    <type>zip</type>
                                    <outputDirectory>target/dependencies/win</outputDirectory>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                    <execution>
                        <id>unpack-camel</id>
                        <phase>generate-resources</phase>
                        <goals>
                            <goal>unpack</goal>
                        </goals>
                        <configuration>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>org.apache.camel</groupId>
                                    <artifactId>apache-camel</artifactId>
                                    <version>${camel.version}</version>
                                    <type>tar.gz</type>
                                    <outputDirectory>target/dependencies/camel</outputDirectory>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                    <execution>
                        <id>unpack-cxf</id>
                        <phase>generate-resources</phase>
                        <goals>
                            <goal>unpack</goal>
                        </goals>
                        <configuration>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>org.apache.cxf</groupId>
                                    <artifactId>apache-cxf</artifactId>
                                    <version>${cxf.version}</version>
                                    <type>tar.gz</type>
                                    <outputDirectory>target/dependencies/cxf</outputDirectory>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                    <execution>
                        <id>unpack-zookeeper</id>
                        <phase>generate-resources</phase>
                        <goals>
                            <goal>unpack</goal>
                        </goals>
                        <configuration>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>org.apache.zookeeper</groupId>
                                    <artifactId>zookeeper</artifactId>
                                    <version>${zookeeper.package.version}</version>
                                    <type>tar.gz</type>
                                    <outputDirectory>target/dependencies/zookeeper</outputDirectory>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                    <execution>
                        <id>unpack-activemq</id>
                        <phase>generate-resources</phase>
                        <goals>
                            <goal>unpack</goal>
                        </goals>
                        <configuration>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>org.apache.activemq</groupId>
                                    <artifactId>apache-activemq</artifactId>
                                    <version>${activemq.version}</version>
                                    <type>tar.gz</type>
                                    <classifier>bin</classifier>
                                    <outputDirectory>target/dependencies/activemq-unix</outputDirectory>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>org.apache.activemq</groupId>
                                    <artifactId>apache-activemq</artifactId>
                                    <version>${activemq.version}</version>
                                    <type>zip</type>
                                    <classifier>bin</classifier>
                                    <outputDirectory>target/dependencies/activemq-win</outputDirectory>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <artifactId>maven-antrun-plugin</artifactId>
                <version>1.8</version>
                <executions>
                    <execution>
                        <id>collect-add-ons</id>
                        <phase>generate-resources</phase>
                        <configuration>
                            <target>
                                <patternset id="no.sources.javadoc">
                                    <exclude name="**/target/*-sources.*" />
                                    <exclude name="**/target/*-javadoc.*" />
                                </patternset>
                                <copy todir="target/add-ons/sam">
                                    <fileset dir="${basedir}/../sam">
                                        <include name="**/target/*.jar" />
                                        <include name="**/target/*.war" />
                                        <exclude name="**/sam-example*.*" />
                                        <patternset refid="no.sources.javadoc"/>
                                    </fileset>
                                    <flattenmapper />
                                </copy>
                                <copy todir="target/add-ons/locator">
                                    <fileset dir="${basedir}/../locator">
                                        <include name="**/target/*.jar" />
                                        <include name="**/target/*.war" />
                                        <patternset refid="no.sources.javadoc"/>
                                    </fileset>
                                    <fileset dir="${basedir}/../locator-service">
                                        <include name="**/target/*.jar" />
                                        <patternset refid="no.sources.javadoc"/>
                                    </fileset>
                                    <flattenmapper />
                                </copy>
                                <copy todir="target/add-ons/locator">
                                    <fileset dir="${basedir}/../locator-service/locator-service-common/src/main/resources/model">
                                        <include name="**/*.*" />
                                    </fileset>
                                </copy>
                                <copy todir="target/add-ons/job">
                                    <fileset dir="${basedir}/../job">
                                        <include name="**/target/*.jar" />
                                        <include name="**/target/*.war" />
                                        <patternset refid="no.sources.javadoc"/>
                                    </fileset>
                                    <flattenmapper />
                                </copy>
                                <copy todir="target/add-ons/datasources/sap">
                                    <fileset dir="${basedir}/../talend-sapjco3-connector">
                                        <include name="**/target/*.jar" />
                                        <patternset refid="no.sources.javadoc"/>
                                    </fileset>
                                    <flattenmapper />
                                </copy>
                                <copy todir="target/add-ons/registry/lib">
                                    <fileset dir="${basedir}/../policies">
                                        <include name="**/target/*.jar" />
                                        <include name="**/target/*.war" />
                                        <patternset refid="no.sources.javadoc"/>
                                    </fileset>
                                    <flattenmapper />
                                </copy>
                                <selector id="not.already.in">
                                    <none>
                                        <present targetdir="target/dependencies/camel/apache-camel-${camel.version}/lib">
                                            <mapper type="flatten" />
                                        </present>
                                        <present targetdir="target/dependencies/cxf/apache-cxf-${cxf.version}/lib">
                                            <mapper type="flatten" />
                                        </present>
                                        <present targetdir="target/dependencies/cxf/apache-cxf-${cxf.version}/modules">
                                            <mapper type="flatten" />
                                        </present>
                                        <present targetdir="target/add-ons/sam">
                                            <mapper type="flatten" />
                                        </present>
                                        <present targetdir="target/add-ons/locator">
                                            <mapper type="flatten" />
                                        </present>
                                        <present targetdir="target/add-ons/job">
                                            <mapper type="flatten" />
                                        </present>
                                        <present targetdir="target/add-ons/registry/lib">
                                            <mapper type="flatten" />
                                        </present>
                                    </none>
                                </selector>
                                <copy todir="target/add-ons/lib">
                                    <fileset dir="${basedir}/../sam">
                                        <include name="**/target/dependency/*.jar" />
                                        <selector refid="not.already.in"/>
                                    </fileset>
                                    <fileset dir="${basedir}/../locator">
                                        <include name="**/target/dependency/*.jar" />
                                        <selector refid="not.already.in"/>
                                    </fileset>
                                    <fileset dir="${basedir}/../job">
                                        <include name="**/target/dependency/*.jar" />
                                        <selector refid="not.already.in"/>
                                    </fileset>
                                    <fileset dir="${basedir}/../policies">
                                        <include name="**/target/dependency/*.jar" />
                                        <selector refid="not.already.in"/>
                                    </fileset>
                                    <flattenmapper />
                                </copy>
                            </target>
                        </configuration>
                        <goals>
                            <goal>run</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>patch-features-files</id>
                        <phase>generate-resources</phase>
                        <configuration>
                            <target>
                                <replace file="target/dependencies/apache-camel-${camel.version}-features.xml">
                                    <replacefilter>
                                        <replacetoken>mvn:org.apache.camel/camel-core/${camel.version}&lt;</replacetoken>
                                        <replacevalue>mvn:org.apache.camel/camel-core/${camel.version}.tesb1&lt;</replacevalue>
                                    </replacefilter>
                                    <replacefilter
                                        token="apache-cxf/3.2.7/xml/features"
                                        value="apache-cxf/${cxf.version}/xml/features"/>
                                    <replacefilter
                                        token="pax-cdi-features/1.0.0.RC1/xml/features"
                                        value="pax-cdi-features/${pax-cdi.version}/xml/features"/>
                                    <!-- patch for xalan and xerces version -->
                                    <replacefilter>
                                        <replacetoken>&lt;bundle dependency='true'&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xalan/2.7.2_3&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>&lt;bundle dependency='true'&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xerces/2.11.0_1&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <!-- Patch TESB-18685 -->
                                    <replacefilter>
                                        <replacetoken>mvn:org.apache.abdera/abdera-parser/1.1.3</replacetoken>
                                        <replacevalue>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.abdera-parser/1.1.3_2</replacevalue>
                                    </replacefilter>
                                    <!-- patch CAMEL-13241 -->
                                    <replacefilter
                                        token="${backport-util-concurrent-version}"
                                        value="3.1"/>
                                    <!-- Patch the TESB-25669 -->
                                    <replacefilter>
                                        <replacetoken>&lt;bundle dependency='true'&gt;mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.saaj-api-1.3/2.9.0&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>mvn:org.codehaus.woodstox/woodstox-core-asl/4.4.1</replacetoken>
                                        <replacevalue>mvn:com.fasterxml.woodstox/woodstox-core/5.0.3</replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>mvn:org.codehaus.woodstox/woodstox-core-asl/4.3.0</replacetoken>
                                        <replacevalue>mvn:com.fasterxml.woodstox/woodstox-core/5.0.3</replacevalue>
                                    </replacefilter>
                                    <!-- patch the jackson version (TESB-26035) -->
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-core/2.9.7"
                                        value="mvn:com.fasterxml.jackson.core/jackson-core/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-databind/2.9.7"
                                        value="mvn:com.fasterxml.jackson.core/jackson-databind/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-annotations/2.9.7"
                                        value="mvn:com.fasterxml.jackson.core/jackson-annotations/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-cbor/2.9.7"
                                        value="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-cbor/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-csv/2.9.7"
                                        value="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-csv/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-smile/2.9.7"
                                        value="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-smile/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-xml/2.9.7"
                                        value="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-xml/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-yaml/2.9.7"
                                        value="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-yaml/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.datatype/jackson-datatype-guava/2.9.7"
                                        value="mvn:com.fasterxml.jackson.datatype/jackson-datatype-guava/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.datatype/jackson-datatype-jdk8/2.9.7"
                                        value="mvn:com.fasterxml.jackson.datatype/jackson-datatype-jdk8/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.datatype/jackson-datatype-jsr310/2.9.7"
                                        value="mvn:com.fasterxml.jackson.datatype/jackson-datatype-jsr310/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.jaxrs/jackson-jaxrs-base/2.9.7"
                                        value="mvn:com.fasterxml.jackson.jaxrs/jackson-jaxrs-base/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.jaxrs/jackson-jaxrs-json-provider/2.9.7"
                                        value="mvn:com.fasterxml.jackson.jaxrx/jackson-jaxrs-json-provider/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.jr/jackson-jr-objects/2.9.7"
                                        value="mvn:com.fasterxml.jackson.jr/jackson-jr-objects/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.module/jackson-module-afterburner/2.9.7"
                                        value="mvn:com.fasterxml.jackson.module/jackson-module-afterburner/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.module/jackson-module-jaxb-annotations/2.9.7"
                                        value="mvn:com.fasterxml.jackson.module/jackson-module-jaxb-annotations/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.module/jackson-module-jsonSchema/2.9.7"
                                        value="mvn:com.fasterxml.jackson.module/jackson-module-jsonSchema/${jackson.version}"/>
                                    <!-- <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-core/2.6.1"
                                        value="mvn:com.fasterxml.jackson.core/jackson-core/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-databind/2.6.1"
                                        value="mvn:com.fasterxml.jackson.core/jackson-databind/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-annotations/2.6.1"
                                        value="mvn:com.fasterxml.jackson.core/jackson-annotations/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.jaxrs/jackson-jaxrs-base/2.6.1"
                                        value="mvn:com.fasterxml.jackson.jaxrs/jackson-jaxrs-base/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.jaxrs/jackson-jaxrs-json-provider/2.6.1"
                                        value="mvn:com.fasterxml.jackson.jaxrx/jackson-jaxrs-json-provider/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.module/jackson-module-jaxb-paranamer/2.6.1"
                                        value="mvn:com.fasterxml.jackson.module/jackson-module-jaxb-paranamer/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.module/jackson-module-scala_2.11/2.6.1"
                                        value="mvn:com.fasterxml.jackson.module/jackson-module-scala_2.11/${jackson.version}"/> -->
                                    <!-- patch the jetty version (TESB-25945) -->
                                    <replacefilter
                                        token="/9.4.12.v20180830&lt;"
                                        value="/${jetty.version}&lt;"/>
                                </replace>
                                <!-- Patch jetty version range in Camel features (TESB-18114/CAMEL-10433) -->
                                <replaceregexp byline="false" flags="gim"
                                        file="target/dependencies/apache-camel-${camel.version}-features.xml"
                                        match="^(\s*&lt;details&gt;camel-jetty9.*\s*)\s*(\s*&lt;feature&gt;jetty&lt;/feature&gt;)$"
                                        replace="\1&lt;feature version='[9,10)'&gt;jetty&lt;/feature&gt;">
                                </replaceregexp>
                                <replace file="target/dependencies/apache-cxf-${cxf.version}-features.xml">
                                    <!-- patch for xalan and xerces version -->
                                    <replacefilter>
                                        <replacetoken>&lt;bundle start-level="30"&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xalan/2.7.2_3&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>&lt;bundle start-level="30" dependency="true"&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xerces/2.11.0_1&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <!-- Patch used jetty version in CXF (TESB-16331) -->
                                    <replacefilter>
                                        <replacetoken>feature version="[7,10)"&gt;jetty&lt;</replacetoken>
                                        <replacevalue>feature version="[9,10)"&gt;jetty&lt;</replacevalue>
                                    </replacefilter>
                                    <!-- Patch the TESB-23159 -->
                                    <replacefilter>
                                        <replacetoken>mvn:com.fasterxml.woodstox/woodstox-core/5.1.0</replacetoken>
                                        <replacevalue>mvn:com.fasterxml.woodstox/woodstox-core/5.0.3</replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>mvn:org.codehaus.woodstox/stax2-api/4.1</replacetoken>
                                        <replacevalue>mvn:org.codehaus.woodstox/stax2-api/3.1.4</replacevalue>
                                    </replacefilter>
                                    <!-- Patch the TESB-24618 Upgrade CXF 3.3.1 -->
                                    <replacefilter>
                                        <replacetoken>&lt;bundle start-level="10" dependency="true"&gt;mvn:jakarta.xml.bind/jakarta.xml.bind-api/2.3.2&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>&lt;bundle start-level="20"&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.jaxb-runtime/2.3.1_1&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>&lt;bundle start-level="20"&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.jaxb-xjc/2.3.1_1&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>&lt;bundle start-level="20"&gt;mvn:com.sun.istack/istack-commons-runtime/3.0.7&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>&lt;bundle start-level="30" dependency="true"&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xerces/2.12.0_1&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <!-- Patch the TESB-25669 -->
                                    <replacefilter>
                                        <replacetoken>&lt;bundle start-level="10" dependency="true"&gt;mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.saaj-api-1.3/2.9.0&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>&lt;bundle start-level="25"&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.saaj-impl/1.3.23_2&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <replacefilter>
                                        <replacetoken>&lt;bundle start-level="25"&gt;mvn:org.jvnet.staxex/stax-ex/1.7.6&lt;/bundle&gt;</replacetoken>
                                        <replacevalue></replacevalue>
                                    </replacefilter>
                                    <!-- patch the jackson version (TESB-26035) -->
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-core/2.9.8"
                                        value="mvn:com.fasterxml.jackson.core/jackson-core/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-databind/2.9.8"
                                        value="mvn:com.fasterxml.jackson.core/jackson-databind/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-annotations/2.9.8"
                                        value="mvn:com.fasterxml.jackson.core/jackson-annotations/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-yaml/2.9.8"
                                        value="mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-yaml/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.module/jackson-module-jaxb-annotations/2.9.8"
                                        value="mvn:com.fasterxml.jackson.module/jackson-module-jaxb-annotations/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.jaxrs/jackson-jaxrs-base/2.9.8"
                                        value="mvn:com.fasterxml.jackson.jaxrs/jackson-jaxrs-base/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.jaxrs/jackson-jaxrs-json-provider/2.9.8"
                                        value="mvn:com.fasterxml.jackson.jaxrs/jackson-jaxrs-json-provider/${jackson.version}"/>
                                    <!-- patch for cxf-rt-transports-http-jetty (TESB-25945) -->
                                    <replacefilter
                                        token="mvn:org.apache.cxf/cxf-rt-transports-http-jetty/3.3.1&lt;"
                                        value="mvn:org.apache.cxf/cxf-rt-transports-http-jetty/3.3.1.tesb1&lt;"/>
                                </replace>
                                <replace file="target/dependencies/framework-${karaf.version}-features.xml">
                                    <!-- patch for pax-logging-log4j2 (TESB-20573) -->
                                    <replacefilter
                                        token="org.ops4j.pax.logging/pax-logging-log4j2/${pax-logging.version}&lt;"
                                        value="org.ops4j.pax.logging/pax-logging-log4j2/${pax-logging.version}/jar/TESB&lt;"/>
                                    <!-- patch for Karaf org.apache.karaf.features.core bundle (TESB-25565) -->
                                    <replacefilter
                                        token="org.apache.karaf.features/org.apache.karaf.features.core/${karaf.version}&lt;"
                                        value="org.apache.karaf.features/org.apache.karaf.features.core/${karaf.version}/jar/TESB&lt;"/>
                                </replace>
                                <replace file="target/dependencies/standard-${karaf.version}-features.xml">
                                    <!-- patch for Karaf org.apache.karaf.features.core bundle (TESB-25565) -->
                                    <replacefilter
                                        token="org.apache.karaf.features/org.apache.karaf.features.core/${karaf.version}&lt;"
                                        value="org.apache.karaf.features/org.apache.karaf.features.core/${karaf.version}/jar/TESB&lt;"/>
                                    <!-- patch for org.apache.aries.blueprint.core (TESB-25393) -->
                                    <replacefilter
                                        token="mvn:org.apache.aries.blueprint/org.apache.aries.blueprint.core/${blueprint.core.version}&lt;"
                                        value="mvn:org.apache.aries.blueprint/org.apache.aries.blueprint.core/${blueprint.core.version}/jar/TESB&lt;"/>
                                    <!-- patch for org.apache.karaf.config.core (TESB-25795) -->
                                    <replacefilter
                                        token="mvn:org.apache.karaf.config/org.apache.karaf.config.core/${karaf.version}&lt;"
                                        value="mvn:org.apache.karaf.config/org.apache.karaf.config.core/${karaf.version}.tesb1&lt;"/>
                                    <!-- patch for org.apache.karaf.jaas.modules (TESB-26507) -->
                                    <replacefilter
                                        token="mvn:org.apache.karaf.jaas/org.apache.karaf.jaas.modules/${karaf.version}&lt;"
                                        value="mvn:org.apache.karaf.jaas/org.apache.karaf.jaas.modules/${karaf.version}.tesb1&lt;"/>
                                    <!-- upgrade Jetty version to 9.4.18.v20190429 (TESB-25945) -->
                                    <replacefilter
                                        token="9.4.12.v20180830"
                                        value="${jetty.version}"/>
                                    <replacefilter
                                        token="mvn:org.ops4j.pax.web/pax-web-features/7.2.8/xml/features"
                                        value="mvn:org.ops4j.pax.web/pax-web-features/${pax-web.version}/xml/features"/>
                                    <replacefilter>
                                        <replacetoken>feature name="pax-http-service" description="Pax-Web OSGi HTTP Service" version="7.2.8"</replacetoken>
                                        <replacevalue>feature name="pax-http-service" description="Pax-Web OSGi HTTP Service" version="${pax-web.version}"</replacevalue>
                                    </replacefilter>
                                 </replace>
                                 <!-- patch for pax-logging-log4j2 (TESB-20573) -->
                                 <replaceregexp byline="true"
                                        match="^(\s*mvn\\:org\.ops4j\.pax\.logging/pax-logging-log4j2/${pax-logging.version})(\s*=.*)$"
                                        replace="\1/jar/TESB\2${line.separator}mvn\\\\:javax\.annotation/javax\.annotation-api/${javax-annotation.version} = 10">
                                    <fileset dir="target/dependencies/unix/apache-karaf-${karaf.version}/etc/">
                                        <include name="startup.properties"/>
                                    </fileset>
                                    <fileset dir="target/dependencies/win/apache-karaf-${karaf.version}/etc/">
                                        <include name="startup.properties"/>
                                    </fileset>
                                 </replaceregexp>
                                 <!-- patch for Karaf org.apache.karaf.features.core bundle (TESB-25565) -->
                                 <replaceregexp byline="true"
                                           match="^(\s*mvn\\:org.apache.karaf.features/org.apache.karaf.features.core/${karaf.version})(\s*=.*)$"
                                           replace="\1/jar/TESB\2">
                                    <fileset dir="target/dependencies/unix/apache-karaf-${karaf.version}/etc/">
                                        <include name="startup.properties"/>
                                    </fileset>
                                    <fileset dir="target/dependencies/win/apache-karaf-${karaf.version}/etc/">
                                        <include name="startup.properties"/>
                                    </fileset>
                                 </replaceregexp>

                                <replace file="target/dependencies/enterprise-${karaf.version}-features.xml">
                                    <!-- patch the jackson version (TESB-26035) -->
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-core/2.9.6"
                                        value="mvn:com.fasterxml.jackson.core/jackson-core/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-databind/2.9.6"
                                        value="mvn:com.fasterxml.jackson.core/jackson-databind/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-annotations/2.9.6"
                                        value="mvn:com.fasterxml.jackson.core/jackson-annotations/${jackson.version}"/>
                                </replace>
                                <replace file="target/dependencies/spring-${karaf.version}-features.xml">
                                    <!-- patch the jackson version (TESB-26035) -->
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-core/2.9.6"
                                        value="mvn:com.fasterxml.jackson.core/jackson-core/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-databind/2.9.6"
                                        value="mvn:com.fasterxml.jackson.core/jackson-databind/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-annotations/2.9.6"
                                        value="mvn:com.fasterxml.jackson.core/jackson-annotations/${jackson.version}"/>
                                </replace>
                                <replace file="target/dependencies/spring-legacy-${karaf.version}-features.xml">
                                    <!-- patch dependencies for jetty  version (TESB-25945) -->
                                    <replacefilter
                                        token="mvn:org.ops4j.pax.web/pax-web-features/7.2.8/xml/features"
                                        value="mvn:org.ops4j.pax.web/pax-web-features/${pax-web.version}/xml/features"/>
                                </replace>
                                <replace file="target/dependencies/activemq-karaf-${activemq.version}-features-core.xml">
                                    <replacefilter
                                        token="&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xstream/1.4.8_1&lt;"
                                        value="&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xstream/1.4.10_1&lt;"/>
                                    <!-- patch the jackson version (TESB-26035) -->
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-core/2.9.8"
                                        value="mvn:com.fasterxml.jackson.core/jackson-core/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-databind/2.9.8"
                                        value="mvn:com.fasterxml.jackson.core/jackson-databind/${jackson.version}"/>
                                    <replacefilter
                                        token="mvn:com.fasterxml.jackson.core/jackson-annotations/2.9.8"
                                        value="mvn:com.fasterxml.jackson.core/jackson-annotations/${jackson.version}"/>
                                </replace>
                                <!-- patch the activemq-webconsole cfg (TESB-26606) -->
                                <replace file="target/dependencies/activemq-karaf-${activemq.version}-activemq-webconsole.cfg">
                                    <replacefilter
                                        token="webconsole.jmx.user=karaf"
                                        value="webconsole.jmx.user="/>
                                    <replacefilter
                                        token="webconsole.jmx.password=karaf"
                                        value="webconsole.jmx.password="/>
                                    <replacefilter
                                        token="webconsole.jms.user=karaf"
                                        value="webconsole.jms.user="/>
                                    <replacefilter
                                        token="webconsole.jms.password=karaf"
                                        value="webconsole.jms.password="/>
                                </replace>
                                <!-- patch for decanter bundles (TESB-24788) -->
                                <replace file="target/dependencies/apache-karaf-decanter-${decanter.version}-features.xml">
                                    <replacefilter
                                        token="&gt;mvn:org.apache.karaf.decanter.appender/org.apache.karaf.decanter.appender.jms/${decanter.version}&lt;"
                                        value="&gt;mvn:org.apache.karaf.decanter.appender/org.apache.karaf.decanter.appender.jms/${decanter.version}.tesb1&lt;"/>
                                    <replacefilter
                                        token="&gt;mvn:org.apache.karaf.decanter.appender/org.apache.karaf.decanter.appender.jms/${decanter.version}/cfg&lt;"
                                        value="&gt;mvn:org.apache.karaf.decanter.appender/org.apache.karaf.decanter.appender.jms/${decanter.version}.tesb1/cfg&lt;"/>
                                    <replacefilter
                                        token="&gt;mvn:org.apache.karaf.decanter.collector/org.apache.karaf.decanter.collector.jms/${decanter.version}&lt;"
                                        value="&gt;mvn:org.apache.karaf.decanter.collector/org.apache.karaf.decanter.collector.jms/${decanter.version}.tesb1&lt;"/>
                                    <replacefilter
                                        token="&gt;mvn:org.apache.karaf.decanter.collector/org.apache.karaf.decanter.collector.jms/${decanter.version}/cfg&lt;"
                                        value="&gt;mvn:org.apache.karaf.decanter.collector/org.apache.karaf.decanter.collector.jms/${decanter.version}.tesb1/cfg&lt;"/>
                                </replace>
                            </target>
                        </configuration>
                        <goals>
                            <goal>run</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>convert-snapshot-file-names</id>
                        <phase>process-resources</phase>
                        <configuration>
                            <target>
                                <!-- convert file names from versioned to non-versioned SNAPSHOTs (TESB-25311) -->
                                <move todir="target/features-repo">
                                    <fileset dir="target/features-repo"/>
                                    <mapper type="regexp" from="^(.*)-[0-9]{8}\.[0-9]{6}-[0-9]*(.*)$$" to="\1-SNAPSHOT\2"/>
                                </move>
                            </target>
                        </configuration>
                        <goals>
                            <goal>run</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-assembly-plugin</artifactId>
                <version>2.4</version>
                <executions>
                    <execution>
                        <id>bin</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>
                        <configuration>
                            <descriptors>
                                <descriptor>src/main/descriptors/win-bin.xml</descriptor>
                                <descriptor>src/main/descriptors/unix-bin.xml</descriptor>
                            </descriptors>
                            <appendAssemblyId>false</appendAssemblyId>
                            <tarLongFileMode>gnu</tarLongFileMode>
                            <finalName>TESB_SE-V${packages.version}</finalName>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-site-plugin</artifactId>
                <configuration>
                    <skip>true</skip>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-pmd-plugin</artifactId>
                <configuration>
                    <skip>true</skip>
                </configuration>
            </plugin>
        </plugins>
    </build>

    <repositories>
        <repository>
            <id>springsource.release</id>
            <name>Springsource release repository</name>
            <url>https://repository.springsource.com/maven/bundles/release</url>
            <releases>
                <enabled>true</enabled>
            </releases>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <repository>
            <id>ops4j.sonatype.snapshots</id>
            <name>OPS4J snapshot repository</name>
            <url>https://oss.sonatype.org/content/repositories/ops4j-snapshots/</url>
            <releases>
                <enabled>false</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
        <!-- OSSRH snapshots -->
        <repository>
            <id>ossrh.sonatype.snapshots.deploy</id>
            <name>OSSRH snapshot repository</name>
            <url>https://oss.sonatype.org/content/groups/public/</url>
            <releases>
                <enabled>false</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
    </repositories>
</project>

